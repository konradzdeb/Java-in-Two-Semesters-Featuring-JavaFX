<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ABBYY FineReader PDF 15">
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:6pt Arial, sans-serif; }
 .font1 { font:8pt Arial, sans-serif; }
 .font2 { font:10pt Arial, sans-serif; }
 .font3 { font:12pt Arial, sans-serif; }
 .font4 { font:10pt Segoe UI, sans-serif; }
 .font5 { font:7pt SimHei, sans-serif; }
 .font6 { font:10pt SimHei, sans-serif; }
 .font7 { font:10pt SimSun, serif; }
 .font8 { font:10pt Times New Roman, serif; }

</style>
</head>
<body>
<p><span class="font8">19.2 </span><span class="font7">创建用户账户</span></p>
<p><span class="font8">395</span></p>
<p><span class="font1">{% endblock content %}</span></p>
<p><span class="font7">这个模板继承了</span><span class="font8">6@$©</span><span class="font7">扭曲，旨在确保登录页面的外观与网站的其他页面相同。请注意，一个 应用程序中的模板可继承另一个应用程序中的模板。</span></p>
<p><span class="font7">如果表单的</span><span class="font4">errors</span><span class="font7">属性被设置，我们就显示一条错误消息（见</span><span class="font6">❶</span><span class="font7">），指出输入的用户名</span><span class="font6">-</span><span class="font7">密码 对与数据库中存储的任何用户名</span><span class="font6">—</span><span class="font7">密码对都不匹配。</span></p>
<p><span class="font7">我们要让登录视图处理表单，因此将实参</span><span class="font4">action</span><span class="font7">设置为登录页面的</span><span class="font8">URL </span><span class="font7">（见</span><span class="font6">❷</span><span class="font7">）。登录视图 将一个表单发送给模板，在模板中，我们显示这个表单（见</span><span class="font6">❸</span><span class="font7">）并添加一个提交按钮（见</span><span class="font6">❹</span><span class="font7">）。 在</span><span class="font6">❺</span><span class="font7">处，我们包含了一个隐藏的表单元素——</span><span class="font4">‘next'</span><span class="font7">，其中的实参</span><span class="font4">value</span><span class="font7">告诉</span><span class="font8">Django</span><span class="font7">在用户成功登 录后将其重定向到什么地方</span><span class="font8">——</span><span class="font7">在这里是主页。</span></p>
<ul style="list-style:none;"><li>
<p><span class="font2">2.</span><span class="font6"> 链接到登录页面</span></p></li></ul>
<p><span class="font7">下面在</span><span class="font8">basehtml</span><span class="font7">中添加到登录页面的链接，让所有页面都包含它。用户已登录时，我们不想 显示这个链接，因此将它嵌套在一个</span><span class="font4">{</span><span class="font6">% </span><span class="font4">if </span><span class="font6">%</span><span class="font4">}</span><span class="font7">标签中：</span></p>
<p><span class="font2">base.html</span></p>
<p><span class="font1">&lt;p&gt;</span></p>
<ul style="list-style:none;"><li>
<p><span class="font1">&lt;a href=&quot;{% url 'learning_logs:index' %}&quot;&gt;Learning Log&lt;/a&gt; -</span></p></li>
<li>
<p><span class="font1">&lt;a href=&quot;{% url 'learning_logs:topics' %}&quot;&gt;Topics&lt;/a&gt; -</span></p></li></ul>
<p><span class="font0">❶</span><span class="font5"> &nbsp;&nbsp;</span><span class="font1">{% if user.is_authenticated %}</span></p>
<p><span class="font0">❷</span><span class="font5"> </span><span class="font1">Hello, {{ user.username }}.</span></p>
<ul style="list-style:none;"><li>
<p><span class="font1">{% else %}</span></p></li></ul>
<p><span class="font0">❸</span><span class="font5"> </span><span class="font1">&lt;a href=&quot;{% url 'users:login' %}&quot;&gt;log in&lt;/a&gt;</span></p>
<ul style="list-style:none;"><li>
<p><span class="font1">{% endif %}</span></p></li></ul>
<p><span class="font1">&lt;/p&gt;</span></p>
<p><span class="font1">{% block content %}{% endblock content %}</span></p>
<p><span class="font7">在</span><span class="font8">Django</span><span class="font7">身份验证系统中，每个模板都可使用变量</span><span class="font4">user</span><span class="font7">，这个变量有一个</span><span class="font4">is_authenticated </span><span class="font7">属性：如果用户已登录，该属性将为</span><span class="font4">True</span><span class="font7">，否则为</span><span class="font4">False</span><span class="font7">。这让你能够向已通过身份验证的用户 显示一条消息，而向未通过身份验证的用户显示另一条消息。</span></p>
<p><span class="font7">在这里，我们向已登录的用户显示一条问候语（见</span><span class="font6">❶</span><span class="font7">）。对于已通过身份验证的用户，还设 置了属性</span><span class="font4">username</span><span class="font7">，我们使用这个属性来个性化问候语，让用户知道他已登录（见</span><span class="font6">❷</span><span class="font7">）。在</span><span class="font6">❸</span><span class="font7">处， 对于还未通过身份验证的用户，我们再显示一个到登录页面的链接。</span></p>
<ul style="list-style:none;"><li>
<p><span class="font2">3.</span><span class="font6"> 使用登录页面</span></p></li></ul>
<p><span class="font7">前面建立了一个用户账户，下面来登录一下，看看登录页面是否管用。请访问 </span><a href="http://localhost:8000/admin/%ef%bc%8c%e5%a6%82%e6%9e%9c%e4%bd%a0%e4%be%9d%e7%84%b6%e6%98%af%e4%bb%a5%e7%ae%a1%e7%90%86%e5%91%98%e7%9a%84%e8%ba%ab%e4%bb%bd%e7%99%bb%e5%bd%95%e7%9a%84%ef%bc%8c%e8%af%b7%e5%9c%a8%e9%a1%b5%e7%9c%89%e4%b8%8a%e6%89%be%e5%88%b0%e6%b3%a8%e9%94%80%e9%93%be%e6%8e%a5%e5%b9%b6"><span class="font8">http://localhost:8000/admin/</span><span class="font7">，如果你依然是以管理员的身份登录的，请在页眉上找到注销链接并</span></a><span class="font7"> 单击它。</span></p>
<p><span class="font7">注销后，访问</span><a href="http://localhost:8000/users/login/%ef%bc%8c%e4%bd%a0%e5%b0%86%e7%9c%8b%e5%88%b0%e7%b1%bb%e4%bc%bc%e4%ba%8e%e5%9b%be19-4%e6%89%80%e7%a4%ba%e7%9a%84%e7%99%bb%e5%bd%95%e9%a1%b5%e9%9d%a2%e3%80%82%e8%be%93%e5%85%a5"><span class="font8">http://localhost:8000/users/login/</span><span class="font7">，你将看到类似于图</span><span class="font8">19-4</span><span class="font7">所示的登录页面。输入</span></a><span class="font7"> 你在前面设置的用户名和密码，将进入页面</span><span class="font8">index</span><span class="font7">。。在这个主页的页眉中，显示了一条个性化问 候语，其中包含你的用户名。</span></p>
<p><span class="font3" style="font-weight:bold;">19</span></p>
</body>
</html>