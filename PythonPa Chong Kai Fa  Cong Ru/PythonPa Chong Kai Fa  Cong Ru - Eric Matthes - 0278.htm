<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ABBYY FineReader PDF 15">
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:8pt Arial, sans-serif; }
 .font1 { font:10pt Arial, sans-serif; }
 .font2 { font:12pt Arial, sans-serif; }
 .font3 { font:10pt Segoe UI, sans-serif; }
 .font4 { font:7pt SimHei, sans-serif; }
 .font5 { font:10pt SimHei, sans-serif; }
 .font6 { font:12pt SimHei, sans-serif; }
 .font7 { font:8pt SimSun, serif; }
 .font8 { font:10pt SimSun, serif; }
 .font9 { font:10pt Times New Roman, serif; }

</style>
</head>
<body>
<p><span class="font9">14.1 </span><span class="font8">添加</span><span class="font9">Play</span><span class="font8">按钮</span></p>
<p><span class="font9">261</span></p>
<ul style="list-style:none;"><li><a name="caption1"></a>
<h5><a name="bookmark0"></a><span class="font2"><a name="bookmark1"></a>14.1.3 </span><span class="font6">开始游戏</span></h5></li></ul>
<p><span class="font8">为在玩家单击</span><span class="font9">Play</span><span class="font8">按钮时开始新游戏，需在</span><span class="font9">game_functions.py</span><span class="font8">中添加如下代码，以监视与这 个按钮相关的鼠标事件：</span></p>
<p><span class="font1">game_functions.py</span></p>
<p><span class="font0">def check_events(ai_settings, screen, stats, play_button, ship, bullets): &quot;&quot;&quot;</span><span class="font7">响应按键和鼠标事件</span><span class="font0">&quot;&quot;&quot;</span></p>
<p><span class="font0">for event in pygame.event.get():</span></p>
<p><span class="font0">if event.type == pygame.QUIT:</span></p>
<p><span class="font0">--</span><span class="font0" style="font-style:italic;">snip</span><span class="font0">--</span></p>
<p><span class="font4">❶ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0">elif event.type == pygame.MOUSEBUTTONDOWN:</span></p>
<p><span class="font4">❷ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0">mouse_x, mouse_y = pygame.mouse.get_pos()</span></p>
<p><span class="font4">❸ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0">check_play_button(stats, play_button, mouse_x, mouse_y)</span></p>
<p><span class="font0">def check_play_button(stats, play_button, mouse_x, mouse_y):</span></p>
<p><span class="font0">&quot;&quot;&quot;</span><span class="font7">在玩家单击</span><span class="font0">Play</span><span class="font7">按钮时开始新游戏</span><span class="font0">&quot;&quot;&quot; &nbsp;&nbsp;&nbsp;&nbsp;- &nbsp;&nbsp;&nbsp;&nbsp;-</span></p>
<p><span class="font4">❹ </span><span class="font0">if play_button.rect.collidepoint(mouse_x, mouse_y): stats.game_active = True</span></p>
<p><span class="font8">我们修改了 </span><span class="font3">check_events()</span><span class="font8">的定义，在其中添加了形参</span><span class="font3">stats</span><span class="font8">和</span><span class="font3">play_button</span><span class="font8">。我们将使用</span><span class="font3">stats </span><span class="font8">来访问标志</span><span class="font3">game_active</span><span class="font8">，并使用</span><span class="font3">play_button</span><span class="font8">来检查玩家是否单击了</span><span class="font9">Play</span><span class="font8">按钮。</span></p>
<p><span class="font8">无论玩家单击屏幕的什么地方，</span><span class="font9">Pygame</span><span class="font8">都将检测到一个</span><span class="font3">MOUSEBUTTONDOWN</span><span class="font8">事件(见</span><span class="font5">❶</span><span class="font8">)，但我 们只想让这个游戏在玩家用鼠标单击</span><span class="font9">Play</span><span class="font8">按钮时作出响应。为此，我们使用了</span><span class="font3">pygame.mouse. get_pos()</span><span class="font8">，它返回一个元组，其中包含玩家单击时鼠标的&quot;口</span><span class="font9" style="font-style:italic;">^</span><span class="font8">坐标(见</span><span class="font5">❷</span><span class="font8">)。我们将这些值传递 给函数</span><span class="font3">check_play_button()</span><span class="font8">(见</span><span class="font5">❸</span><span class="font8">)，而这个函数使用</span><span class="font3">collidepoint()</span><span class="font8">检查鼠标单击位置是否在 </span><span class="font9">Play</span><span class="font8">按钮的</span><span class="font3">rect</span><span class="font8">内(见</span><span class="font5">❹)。</span><span class="font8">如果是这样的，我们就将</span><span class="font3">game_active</span><span class="font8">设置为</span><span class="font3">True</span><span class="font8">，让游戏就此开始！</span></p>
<p><span class="font8">在</span><span class="font3">alien_invasion.py</span><span class="font8">中调用</span><span class="font3">check_events(</span><span class="font9">)</span><span class="font8">，需要传递另外两个实参---</span><span class="font3">stats</span><span class="font8">和</span><span class="font3">play_</span></p>
<p><span class="font3">button</span><span class="font8">：</span></p>
<div>
<p><span class="font2" style="font-weight:bold;">14</span></p>
</div><br clear="all">
<p><span class="font1">alien_invasion.py</span></p>
<p><span class="font0"># </span><span class="font7">开始游戏主循环</span></p>
<p><span class="font0">while True:</span></p>
<p><span class="font0">gf.check_events(ai_settings, screen, stats, play_button, ship, bullets)</span></p>
<ul style="list-style:none;"><li>
<p><span class="font0">--</span><span class="font0" style="font-style:italic;">snip</span><span class="font0">--</span></p></li></ul>
<p><span class="font8">至此，你应该能够开始这个游戏了。游戏结束时，</span><span class="font3">game_active</span><span class="font8">应为</span><span class="font3">False</span><span class="font8">，并重新显示</span><span class="font9">Play </span><span class="font8">按钮。</span></p>
<ul style="list-style:none;"><li>
<h5><a name="bookmark2"></a><span class="font2"><a name="bookmark3"></a>14.1.4 </span><span class="font6">重置游戏</span></h5></li></ul>
<p><span class="font8">前面编写的代码只处理了玩家第一次单击</span><span class="font9">Play</span><span class="font8">按钮的情况，而没有处理游戏结束的情况，因 为没有重置导致游戏结束的条件。</span></p>
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
</body>
</html>