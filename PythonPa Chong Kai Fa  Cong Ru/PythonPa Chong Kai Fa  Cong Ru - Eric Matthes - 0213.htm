<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ABBYY FineReader PDF 15">
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:8pt Arial, sans-serif; }
 .font1 { font:10pt Segoe UI, sans-serif; }
 .font2 { font:7pt SimHei, sans-serif; }
 .font3 { font:10pt SimHei, sans-serif; }
 .font4 { font:8pt SimSun, serif; }
 .font5 { font:10pt SimSun, serif; }
 .font6 { font:10pt Times New Roman, serif; }
 .font7 { font:11pt Times New Roman, serif; }

</style>
</head>
<body>
<p><span class="font6">196</span></p>
<p><span class="font5">第</span><span class="font6">11</span><span class="font5">章 测试代码</span></p>
<p><span class="font0">&quot;&quot;&quot;</span><span class="font4">针对 </span><span class="font0">AnonymousSurvey </span><span class="font4">类的测试</span><span class="font0">&quot;&quot;&quot;</span></p>
<p><span class="font0">def test_store_single_response(self): &quot;&quot;&quot;</span><span class="font4">测试单个答案会被妥善地存储</span><span class="font0">&quot;&quot;&quot; question = &quot;What language did you first learn to speak?</span></p>
<p><span class="font2">❸ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0">my_survey = AnonymousSurvey(question)</span></p>
<p><span class="font0">my_survey.store_response('English')</span></p>
<p><span class="font2">❹ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0">self.assertIn('English', my_survey.responses)</span></p>
<p><span class="font0">unittest.main()</span></p>
<p><span class="font5">我们首先导入了模块</span><span class="font1">unittest</span><span class="font5">以及要测试的类</span><span class="font1">AnonymousSurvey</span><span class="font5">。我们将测试用例命名为 </span><span class="font1">TestAnonymousSurvey</span><span class="font5">,它也继承了</span><span class="font1">unittest.TestCase </span><span class="font5">(见</span><span class="font7" style="font-weight:bold;">❶</span><span class="font5">)。第一个测试方法验证调查问题的 单个答案被存储后，会包含在调查结果列表中。对于这个方法，一个不错的描述性名称是 </span><span class="font1">test_store_single_response()</span><span class="font5">(见</span><span class="font3">❷</span><span class="font5">)。如果这个测试未通过，我们就能通过输出中的方法名得 知，在存储单个调查答案方面存在问题。</span></p>
<p><span class="font5">要测试类的行为，需要创建其实例。在</span><span class="font3">❸</span><span class="font5">处，我们使用问题</span><span class="font6">&quot;</span><span class="font1">What language did you first learn to speak?</span><span class="font6">&quot;</span><span class="font5">创建了一个名为</span><span class="font1">my_survey</span><span class="font5">的实例，然后使用方法</span><span class="font1">store_response()</span><span class="font5">存储了单个答案 </span><span class="font1">English</span><span class="font5">。接下来，我们检查</span><span class="font1">English</span><span class="font5">是否包含在列表</span><span class="font1">my_survey.responses</span><span class="font5">中，以核实这个答案是 否被妥善地存储了(见</span><span class="font3">❹</span><span class="font5">)。</span></p>
<p><span class="font5">当我们运行</span><span class="font6">test_survey.py</span><span class="font5">时，测试通过了：</span></p>
<p><span class="font0">Ran 1 test in 0.001s</span></p>
<p><span class="font0">OK</span></p><a name="caption1"></a>
<h6><a name="bookmark0"></a><span class="font5"><a name="bookmark1"></a>这很好，但只能收集一个答案的调查用途不大。下面来核实用户提供三个答案时，它们也将 被妥善地存储。为此，我们在</span><span class="font1">TestAnonymousSurvey</span><span class="font5">中再添加一个方法：</span></h6>
<p><span class="font0">import unittest</span></p>
<p><span class="font0">from survey import AnonymousSurvey</span></p>
<p><span class="font0">class TestAnonymousSurvey(unittest.TestCase):</span></p>
<p><span class="font0">&quot;&quot;&quot;</span><span class="font4">针对 </span><span class="font0">AnonymousSurvey </span><span class="font4">类的测试</span><span class="font0">&quot;&quot;&quot;</span></p>
<p><span class="font0">def test_store_single_response(self):</span></p>
<p><span class="font0">&quot;&quot;&quot;</span><span class="font4">测试单个答案会被妥善地存储</span><span class="font0">&quot;&quot;&quot;</span></p>
<p><span class="font0">--</span><span class="font0" style="font-style:italic;">snip</span><span class="font0">-</span></p>
<p><span class="font0">def test_store_three_responses(self):</span></p>
<p><span class="font0">&quot;&quot;&quot;</span><span class="font4">测试三个答案会被妥善地存储</span><span class="font0">&quot;&quot;&quot;</span></p>
<p><span class="font0">question = &quot;What language did you first learn to speak?&quot;</span></p>
<p><span class="font0">my_survey = AnonymousSurvey(question)</span></p>
<p><span class="font2">❶ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="font0">responses = ['English', 'Spanish', 'Mandarin']</span></p>
<p><span class="font0">for response in responses:</span></p>
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
</body>
</html>