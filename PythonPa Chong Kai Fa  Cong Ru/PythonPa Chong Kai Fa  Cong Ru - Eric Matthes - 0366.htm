<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ABBYY FineReader PDF 15">
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:8pt Arial, sans-serif; }
 .font1 { font:10pt Arial, sans-serif; }
 .font2 { font:12pt Arial, sans-serif; }
 .font3 { font:10pt Segoe UI, sans-serif; }
 .font4 { font:7pt SimHei, sans-serif; }
 .font5 { font:10pt SimHei, sans-serif; }
 .font6 { font:12pt SimHei, sans-serif; }
 .font7 { font:8pt SimSun, serif; }
 .font8 { font:10pt SimSun, serif; }
 .font9 { font:10pt Times New Roman, serif; }

</style>
</head>
<body>
<p><span class="font9">17.2 </span><span class="font8">使用</span><span class="font9">Pygal</span><span class="font8">可视化仓库 &nbsp;&nbsp;</span><span class="font9">349</span></p>
<ul style="list-style:none;"><li><a name="caption1"></a>
<h5><a name="bookmark0"></a><span class="font2"><a name="bookmark1"></a>17.2.3</span><span class="font6"> 根据数据绘图</span></h5></li></ul>
<p><span class="font8">为根据数据绘图，我们将自动生成</span><span class="font3">plot_dicts</span><span class="font8">,其中包含</span><span class="font9">API</span><span class="font8">调用返回的</span><span class="font9">30</span><span class="font8">个项目的信息。</span></p>
<p><span class="font8">完成这种工作的代码如下：</span></p>
<h6><a name="bookmark2"></a><span class="font1"><a name="bookmark3"></a>python_repos.py</span></h6>
<ul style="list-style:none;"><li>
<p><span class="font0">- -</span><span class="font0" style="font-style:italic;">snip</span><span class="font0">--</span></p></li>
<li>
<p><span class="font0">#</span><span class="font7"> 研究有关仓库的信息</span></p></li></ul>
<p><span class="font0">repo_dicts = response_dict['items']</span></p>
<p><span class="font0">print(&quot;Number of items:&quot;, len(repo_dicts))</span></p>
<p><span class="font4">❶ </span><span class="font0">names, plot_dicts = [], </span><span class="font4">口</span></p>
<p><span class="font0">for repo_dict in repo_dicts:</span></p>
<p><span class="font0">names.append(repo_dict['name'])</span></p>
<p><span class="font4">❷ </span><span class="font0">plot_dict = {</span></p>
<p><span class="font0">'value': repo_dict['stargazers_count'],</span></p>
<p><span class="font0">'label': repo_dict['description'],</span></p>
<p><span class="font0">}</span></p>
<p><span class="font4">❸ </span><span class="font0">plot_dicts.append(plot_dict)</span></p>
<ul style="list-style:none;"><li>
<p><span class="font0">#</span><span class="font7"> 可视化</span></p></li></ul>
<p><span class="font0">my_style = LS('#333366', base_style=LCS)</span></p>
<ul style="list-style:none;"><li>
<p><span class="font0">- -snip--</span></p></li></ul>
<p><span class="font4">❹ </span><span class="font0">chart.add('', plot_dicts)</span></p>
<p><span class="font0">chart.render_to_file('python_repos.svg')</span></p>
<p><span class="font8">在</span><span class="font5">❶</span><span class="font8">处，我们创建了两个空列表</span><span class="font3">names</span><span class="font8">和</span><span class="font3">plot_dicts</span><span class="font8">。为生成</span><span class="font9" style="font-style:italic;">x</span><span class="font8">轴上的标签，我们依然需要列 表</span><span class="font3">names</span><span class="font8">。</span></p>
<p><span class="font8">在循环内部，对于每个项目，我们都创建了字典</span><span class="font3">plot_dict </span><span class="font8">(见</span><span class="font5">❷</span><span class="font8">)。在这个字典中，我们使 用键</span><span class="font3">'value'</span><span class="font8">存储了星数，并使用键</span><span class="font3">'label'</span><span class="font8">存储了项目描述。接下来，我们将字典</span><span class="font3">plot_dict</span><span class="font8">附加 到</span><span class="font3">plot_dicts</span><span class="font8">末尾(见</span><span class="font5">❸</span><span class="font8">)。在</span><span class="font5">❹</span><span class="font8">处，我们将列表</span><span class="font3">plot_dicts</span><span class="font8">传递给了</span><span class="font3">add()</span><span class="font8">。图</span><span class="font9">17-4</span><span class="font8">显示了生成的 图表。</span></p>
<p><span class="font2" style="font-weight:bold;">17</span></p>
</body>
</html>