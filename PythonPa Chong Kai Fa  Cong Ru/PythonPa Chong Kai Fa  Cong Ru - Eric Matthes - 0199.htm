<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
	"http://www.w3.org/TR/1998/REC-html40-19980424/loose.dtd">
<html>
<head><meta http-equiv="content-type" content="text/html; charset=UTF-8"><meta name="generator" content="ABBYY FineReader PDF 15">
<style type="text/css">
 table.main {}
 tr.row {}
 td.cell {}
 div.block {}
 div.paragraph {}
 .font0 { font:8pt Arial, sans-serif; }
 .font1 { font:10pt Arial, sans-serif; }
 .font2 { font:10pt Segoe UI, sans-serif; }
 .font3 { font:7pt SimHei, sans-serif; }
 .font4 { font:10pt SimHei, sans-serif; }
 .font5 { font:8pt SimSun, serif; }
 .font6 { font:10pt SimSun, serif; }
 .font7 { font:10pt Times New Roman, serif; }
 .font8 { font:11pt Times New Roman, serif; }

</style>
</head>
<body>
<p><span class="font7">182</span></p>
<p><span class="font6">第</span><span class="font7">10</span><span class="font6">章 文件和异常</span></p>
<p><span class="font6">己的名字，这样再次运行程序时就记住他了。</span></p>
<p><span class="font6">我们先来存储用户的名字：</span></p>
<p><span class="font1">remember_me.py</span></p>
<p><span class="font0">import json</span></p>
<p><span class="font3">❶ </span><span class="font0">username = input(&quot;What is your name?&quot;)</span></p>
<p><span class="font0">filename = 'username.json'</span></p>
<p><span class="font0">with open(filename, 'w') as f_obj:</span></p>
<p><span class="font3">❷ </span><span class="font0">json.dump(username, f_obj)</span></p>
<p><span class="font3">❸ </span><span class="font0">print(&quot;We'll remember you when you come back, &quot;&nbsp;+ username + &quot;!&quot;)</span></p>
<p><span class="font6">在</span><span class="font8" style="font-weight:bold;">0</span><span class="font6">处，我们提示输入用户名，并将其存储在一个变量中。接下来，我们调用</span><span class="font2">json.dump()</span><span class="font6">, 并将用户名和一个文件对象传递给它，从而将用户名存储到文件中(见</span><span class="font4">❷</span><span class="font6">)。然后，我们打印一 条消息，指出我们存储了他输入的信息(见</span><span class="font4">❸</span><span class="font6">)：</span></p>
<p><span class="font0">What is your name? </span><span class="font0" style="font-weight:bold;">Eric</span></p>
<p><span class="font0">We'll remember you when you come back, Eric!</span></p>
<p><span class="font6">现在再编写一个程序，向其名字被存储的用户发出问候：</span></p>
<p><span class="font1">greet_user.py</span></p>
<p><span class="font0">import json</span></p>
<p><span class="font0">filename = 'username.json'</span></p>
<p><span class="font0">with open(filename) as f_obj:</span></p>
<p><span class="font3">❶ </span><span class="font0">username = json.load(f_obj)</span></p>
<p><span class="font3">❷ </span><span class="font0">print(&quot;Welcome back, &quot;&nbsp;+ username + &quot;!&quot;)</span></p>
<p><span class="font6">在</span><span class="font8" style="font-weight:bold;">0</span><span class="font6">处，我们使用</span><span class="font2">3«0</span><span class="font4">门.</span><span class="font2">1</span><span class="font4">。</span><span class="font2">3</span><span class="font6">人)将存储在</span><span class="font7">username.json</span><span class="font6">中的信息读取到变量</span><span class="font2">username</span><span class="font6">中。恢复 用户名后，我们就可以欢迎用户回来了(见</span><span class="font4">❷</span><span class="font6">)：</span></p>
<p><span class="font0">Welcome back, Eric!</span></p>
<p><span class="font6">我们需要将这两个程序合并到一个程序(</span><span class="font7">remember_me.py</span><span class="font6">)中。这个程序运行时，我们将尝 试从文件</span><span class="font7">usernamejson</span><span class="font6">中获取用户名，因此我们首先编写一个尝试恢复用户名的</span><span class="font2">try</span><span class="font6">代码块。如 果这个文件不存在，我们就在</span><span class="font2">except</span><span class="font6">代码块中提示用户输入用户名，并将其存储在</span><span class="font7">usernamejson </span><span class="font6">中，以便程序再次运行时能够获取它：</span></p>
<p><span class="font1">remember_me.py</span></p>
<p><span class="font0">import json</span></p>
<p><span class="font0"># </span><span class="font5">如果以前存储了用户名，就加载它</span></p>
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
<div>
</div><br clear="all">
</body>
</html>